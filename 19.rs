struct Move<'a> {
    map: &'a Vec<Vec<char>>,
    cur: (i32, i32),
    prev: (i32, i32),
}

impl<'a> Move<'a> {
    fn new(map: &'a Vec<Vec<char>>) -> Self {
        let x = map[0].iter().position(|&x| x == '|').unwrap() as i32;
        let cur = (x, 0);
        let prev = (x, -1);
        Move { map, cur, prev }
    }

    fn inside(&self, pos: (i32, i32)) -> bool {
        pos.0 >= 0 && pos.0 < self.map[0].len() as i32 && pos.1 >= 0
            && pos.1 < self.map.len() as i32
    }
    fn get(&self, pos: (i32, i32)) -> char {
        if !self.inside(pos) {
            '.'
        } else {
            self.map[pos.1 as usize][pos.0 as usize]
        }
    }
}

impl<'a> Iterator for Move<'a> {
    type Item = (i32, i32);
    fn next(&mut self) -> Option<Self::Item> {
        let next = if self.get(self.cur) != '+' {
            let next = (2 * self.cur.0 - self.prev.0, 2 * self.cur.1 - self.prev.1);
            self.prev = self.cur;
            self.cur = next;
            next
        } else {
            let next = [(0, 1), (0, -1), (1, 0), (-1, 0)]
                .iter()
                .map(|&(x, y)| (self.cur.0 + x, self.cur.1 + y))
                .filter(|&p| self.get(p) != '.')
                .filter(|&(x, y)| x != self.prev.0 || y != self.prev.1)
                .next()
                .unwrap();
            self.prev = self.cur;
            self.cur = next;
            next
        };
        if self.inside(next) && self.get(next) != '.' {
            return Some(next);
        } else {
            return None;
        }
    }
}

fn main() {
    let map = r"...............................................................|.........................................................................................................................................
.......+-------------------------------------------------------|-----------------------------+.+-------+.+-------+...........+-+...+-------------------------------------------------------------+.......
.......|.......................................................|.............................|.|.......|.|.......|...........|.|...|.............................................................|.......
.......|.....+-------+.....................+---------------+...|.....................+-------|---------|-+.......|.........+-|-----------------------------------------+.........................|.......
.......|.....|.......|.....................|...............|...|.....................|.......|.|.......|.........|.........|.|.|...|...................................|.........................|.......
.......|.....|.......+---------------------|-----------------------------------------|-------|-----+...|.........|.........|.+-|---+.........................+-----------------------------------------+.
.......|.....|.............................|...............|...|.....................|.......|.|...|...|.........|.........|...|.............................|.........|.........................|.....|.
.......|.....|.+---------------------------|---+.+-------+.+---|---+...............+-|-------|-------------------------------+.|.............................|.........|.....................+-+.|.....|.
.......|.....|.|...........................|...|.|.......|.....|...|...............|.|.......|.|...|...|.........|.........|.|.|.............................|.........|.....................|.|.|.....|.
...+---------|---------------------------------|---------|---------|---------------|---------------|---|-------------------|-|-------------------------------|-------+.|.....................|.|.|.....|.
...|...|.....|.|...........................|...|.|.......|.....|...|...............|.|.......|.|...|...|.........|.........|.|.|.............................|.......|.|.....................|.|.|.....|.
...|...+-----|-------------------------------------------------|---|---------------------------|-------|-------------------------------------------------------------------------------+.....|.|.|.....|.
...|.........|.|...........................|...|.|.......|.....|...|...............|.|.......|.|...|...|.........|.........|.|.|.............................|.......|.|...............|.....|.|.|.....|.
...|.........|.|...........................|...+---------|-----|---+...............|.|.......|.|.+-----+.........|.....+---|-+.+-----------------------------|---------|---------------|-----|-----+...|.
...|.........|.|...........................|.....|.......|.....|...................|.|.......|.|.|.|.............|.....|...|.................................|.......|.|...............|.....|.|.|.|...|.
...|.........|.|...........................|...+-+.+-----------|-----------+.......|.|.......|.|.+-------------+.|.....|...|.....................+-------------------+.|...............|.+-----|---|---+.
...|.........|.|...........................|...|...|.....|.....|...........|.......|.|.......|.|...|...........|.|.....|...|.....................|...........|.........|...............|.|...|.|.|.|.....
...|.........|.|.......................+-------|---|-----------|-----------|-------------------|---|-------------|-------------------------------|-----------|---------|---------------+.|...|.|.|.|.....
...|.........|.|.......................|...|...|...|.....|.....|...........|.......|.|.......|.|...|...........|.|.....|...|.....................|...........|.........|.................|...|.|.|.|.....
...|.........|.|.......................|...|...|...+-----|-----------------|-----------------|-+...|...........|.|.....|...|.....................|...........|.........|.................|...|.|.|.|.....
...|.........|.|.......................|...|...|.........|.....|...........|.......|.|.......|.....|...........|.|.....|...|.....................|...........|.........|.................|...|.|.|.|.....
...|.........|.|.......................|...|...|.........|...+-+...........|.......|.|.......|.....|...........|.|.....|...|.....................|...........|.........|.................|...|.|.|.|.....
...|.........|.|.......................|...|...|.........|...|.............|.......|.|.......|.....|...........|.|.....|...|.....................|...........|.........|.................|...|.|.|.|.....
...|.........|.|.......................|...|...|.........|...|.............|.......|.|.......|.....|...........|.|.....|...|.....................|...........|.........|...+-+...........|...|.|.|.|.....
...|.........|.|.......................|...|...|.........|...|.............|.......|.|.......|.....|...........|.|.....|...|.....................|...........|.........|...|.|...........|...|.|.|.|.....
...|.........|.|.......................|...|...|.........|...|.............|.......|.|.......|.....|...........|.|.....|...|...+-----------------|-----------|-----+...|...|.|...........|...|.|.|.|.....
...|.........|.|.......................|...|...|.........|...|.............|.......|.|.......|.....|...........|.|.....|...|...|.................|...........|.....|...|...|.|...........|...|.|.|.|.....
...+-+.+-------------------------------+...|...+---------|-----------------|-------|---------------------------|---------------|-------+.........|...........|.....|...|...|.|...........|...|.|.|.|.....
.....|.|.....|.|...........................|.............|...|.............|.......|.|.......|.....|...........|.|.....|...|...|.......|.........|...........|.....|...|...|.|...........|...|.|.|.|.....
...+-|-|---+.|.|.........+---------------+.|...+-------------|-------------|---------+.......|.....|...+---------|---------|---|---------------+.|...........|.....|...|...|.|.....+-----|-------------+.
...|.|.|...|.|.|.........|...............|.|...|.........|...|.............|.......|.........|.....|...|.......|.|.....|...|...|.......|.......|.|...........|.....|...|...|.|.....|.....|...|.|.|.|...|.
.+-+.|.|...+---------------------+.......|.|...|.+-------------------------|-----------------+.....|...|.......|.|.....|...|...|.......|.......|.|...........|.....|...|...|.|.....|.....+---+.|.|.|...|.
.|...|.|.....|.|.........|.......|.......|.|...|.|.......|...|.............|.......|...............|...|.......|.|.....|...|...|.......|.......|.|...........|.....|...|...|.|.....|...........|.|.|...|.
.|.+-|-|-----------------|-----------------|---|-|-------|---|---------------------|---------------|---|-------|---------------------------------|-------------------+.|...|.|.....|...........|.|.|...|.
.|.|.|.|.....|.|.........|.......|.......|.|...|.|.......|...|.............|.......|...............|...|.......|.|.....|...|...|.......|.......|.|...........|.....|.|.|...|.|.....|...........|.|.|...|.
.|.|.|.|.....|.|.........|.......|.......|.|...|.+---------------------------------|-------+.......|...|.......|.|.....|...|...|.......|.......|.|...........|.....|.|.|...|.|.....+-----------+.|.|...|.
.|.|.|.|.....|.|.........|.......|.......|.|...|.........|...|.............|.......|.......|.......|...|.......|.|.....|...|...|.......|.......|.|...........|.....|.|.|...|.|...................|.|...|.
.|.|.|.|.....|.|.........|.......|.......|.|...|.........|...|.............|.......|.......|...+---|-----------|-|-----+...|...|.......+-------|-------------------+.|.|...|.|...................|.|...|.
.|.|.|.|.....|.|.........|.......|.......|.|...|.........|...|.............|.......|.......|...|...|...|.......|.|.........|...|...............|.|...........|.......|.|...|.|...................|.|...|.
.+-|-----+...|.|.........|.....+-|-------|-----|-------------|-------------|---------------------------|-------|-----------|---|---------------|-|-----------------+.|.|...|.|...................|.|...|.
...|.|.|.|...|.|.........|.....|.|.......|.|...|.........|...|.............|.......|.......|...|...|...|.......|.|.........|...|...............|.|...........|.....|.|.|...|.|...................|.|...|.
.+-------+.+-|-|---+.....|.....|.|.......|.|...|.........|...|.............|.......|.......|...|...|...|...+---|---------------|---------------|---------------+...|.|.|...|.|...................|.|...|.
.|.|.|.|...|.|.|...|.....|.....|.|.......|.|...|.........|...|.............|.......|.......|...|...|...|...|...|.|.........|...|...............|.|...........|.|...|.|.|...|.|...................|.|...|.
.|.+-|-|-+.|.|.|...|.....|.....|.+-------|-|---|-------+.|...|.............|.......|.......|...|...|...|...|...|.|.........|...|...............|.|...........|.|...|.|.|...|.|...................|.|...|.
.|...|.|.|.|.|.|...|.....|.....|.........|.|...|.......|.|...|.............|.......|.......|...|...|...|...|...|.|.........|...|...............|.|...........|.|...|.|.|...|.|...................|.|...|.
.|.+---|---|-|-+.+-------|-----|-----------|---|-------------|-------------|---------------|-----------|-------|-|-------------|-----------+...|.|.+-------------------|-----|-+.................|.|...|.
.|.|.|.|.|.|.|...|.|.....|.....|.........|.|...|.......|.|...|.............|.......|.......|...|...|...|...|...|.|.........|...|...........|...|.|.|.........|.|...|.|.|...|.|.|.................|.|...|.
.|.+-+.|.|.+-|-----|-----------|---------|-|---|-------+.|...|.......+---------+...|.......|...|...|...|...|...|.|.........|...+-----------|-----|-----------------|-----------|-+...............|.|...|.
.|.....|.|...|...|.|.....|.....|.........|.|...|.........|...|.......|.....|...|...|.......|...|...|...|...|...|.|.........|...............|...|.|.|.........|.|...|.|.|...|.|.|.|...............|.|...|.
.|.....|.|.+-----|-------------|---------|-----|---------------------------|-----------------------|-------|-----------------------------+.|...|.|.|.........|.|...|.|.|...|.|.|.|...............|.|...|.
.|.....|.|.|.|...|.|.....|.....|.........|.|...|.........|...|.......|.....|...|...|.......|...|...|...|...|...|.|.........|.............|.|...|.|.|.........|.|...|.|.|...|.|.|.|...............|.|...|.
.|.....|.|.|.|...|.|.....|.....|.........|.|...+---------|---|-------+.....|...|...|.......|...|...|...|...|...|.|.........|.............|.|...|.|.|.....+---+.|...|.|.|...|.|.|.|...............|.|...|.
.|.....|.|.|.|...|.|.....|.....|.........|.|.............|...|.............|...|...|.......|...|...|...|...|...|.|.........|.............|.|...|.|.|.....|.....|...|.|.|...|.|.|.|...............|.|...|.
.+---+.|.|.|.+---|-|-----|-----|-------------------------|---|-------------|-------|-------|-------|---|-------|-|---------|-------------|-|---|---|---+.|.....|...|.|.|...|.|.|.|...............|.|...|.
.....|.|.|.|.....|.|.....|.....|.........|.|.............|...|.............|...|...|.......|...|...|...|...|...|.|.........|.............|.|...|.|.|...|.|.....|...|.|.|...|.|.|.|...............|.|...|.
.....|.|.|.|.....|.|.....|.....|.........|.|.............|.+---------------|---|-------------------|-----------+.|.........|.............|.|...|.|.|...|.|.....|...|.|.|...|.|.|.|.......+---+...|.|...|.
.....|.|.|.|.....|.|.....|.....|.........|.|.............|.|.|.............|...|...|.......|...|...|...|...|.....|.........|.............|.|...|.|.|...|.|.....|...|.|.|...|.|.|.|.......|...|...|.|...|.
.....|.|.|.|...+---------|-----|---------|-----------------|-|---------+...|...|...|.......|...|...|...|...|.....|.........|.............|.|...|.|.|...|.|.....|...|.|.|...|.|.|.|.......|...|...|.|...|.
.....|.|.|.|...|.|.|.....|.....|.........|.|.............|.|.|.........|...|...|...|.......|...|...|...|...|.....|.........|.............|.|...|.|.|...|.|.....|...|.|.|...|.|.|.|.......|...|...|.|...|.
.....|.|.|.|...+-|-|-----------|---------|---------------+.+-|---+.+-------+...|...|.......|...|...|...|...|.....|.........|.............|.|...|.|.|...|.|.....|...|.|.|...|.|.|.|.......|...|...|.|...|.
.....|.|.|.|.....|.|.....|.....|.........|.|.................|...|.|...|.......|...|.......|...|...|...|...|.....|.........|.............|.|...|.|.|...|.|.....|...|.|.|...|.|.|.|.......|...|...|.|...|.
.....|.|.|.|.....|.|.....|.....|.........|.|.................|...|.|...|.....+-------------|-------|---|---------|---------|-------------|-|---|-|-|-----------|---|-------+.|.|.+-------|---|---|-|---+.
.....|.|.|.|.....|.|.....|.....|.........|.|.................|...|.|...|.....|.|...|.......|...|...|...|...|.....|.........|.............|.|...|.|.|...|.|.....|...|.|.|.....|.|.........|...|...|.|.....
.....|.|.|.|.....|.|.....|.....|.........|.|.................|...|.|...|.....|.|...|.......|...|...|...+-----------------------------------|---|-|---------------+.|.|.|.....|.|.........|...|...|.|.....
.....|.|.|.|.....|.|.....|.....|.........|.|.................|...|.|...|.....|.|...|.......|...|...|.......|.....|.........|.............|.|...|.|.|...|.|.....|.|.|.|.|.....|.|.........|...|...|.|.....
.....|.|.|.|...+-|-|-----------|-------+.|.|.................|...|.|.+-|-----|-----------------|---|-------|-----|---------|-------------|-|---|---|---|-----------|-|-|-----|-------------+.|...|.|.....
.....|.|.|.|...|.|.|.....|.....|.......|.|.|.................|...|.|.|.|.....|.|...|.......|...|...|.......|.....|.........|.............|.|...|.|.|...|.|.....|.|.|.|.|.....|.|.........|.|.|...|.|.....
.....|.|.|.|...|.|.|.....|.....|.......|.|.|.................|...|.|.|.|.+-------+.|.......|...|...|.......|.....|.........|.............|.|...|.|.|...|.|.....|.|.+---|-----|-|---+.....|.|.|...|.|.....
.....|.|.|.|...|.|.|.....|.....|.......|.|.|.................|...|.|.|.|.|...|.|.|.|.......|...|...|.......|.....|.........|.............|.|...|.|.|...|.|.....|.|...|.|.....|.|...|.....|.|.|...|.|.....
.....|.|.|.|...|.|.|.....|.....|.......|.|.|.................|.+---+.+---|---|---|---------|---+...|.......|.....|.........|.............|.|...|.|.|...|.|.....|.|...|.|.....|.|...|.....|.|.|...|.|.....
.....|.|.|.|...|.|.|.....|.....|.......|.|.|.................|.|.|.....|.|...|.|.|.|.......|.......|.......|.....|.........|.............|.|...|.|.|...|.|.....|.|...|.|.....|.|...|.....|.|.|...|.|.....
.....|.|.|.|...|.|.|...+-|-----------------|-----------------|-|-----+.|.|...|.|.|.|.......|.......|.......|.....|.........|.............|.|...|.|.|...|.|.....|.|...|.|.....|.|...|.....|.|.|...|.|.....
.....|.|.|.|...|.|.|...|.|.....|.......|.|.|.................|.|.|...|.|.|...|.|.|.|.......|.......|.......|.....|.........|.............|.|...|.|.|...|.|.....|.|...|.|.....|.|...|.....|.|.|...|.|.....
.....|.|.|.|...|.|.|...+-|-------+.....+---|-----------------|---|-+.|.|.|...|.|.|.|.+-----|-------|-------------|---------|-------------|-|-----|-|-----|---+.|.|...|.|.....|.|...|.....|.|.|...|.|.....
.....|.|.|.|...|.|.|.....|.....|.|.......|.|.................|.|.|.|.|.|.|...|.|.|.|.|.....|.......|.......|.....|.........|.............|.|...|.|.|...|.|...|.|.|...|.|.....|.|...|.....|.|.|...|.|.....
.....|.|.|.|.+-|---|-------------------+.|.|.............+-------+.|.|.|.|...|.|.|.|.|.+---|---------------------|---------|-------------|-|---|---|---+.|...|.|.|...|.|.....|.|...|.....|.|.|...|.|.....
.....|.|.|.|.|.|.|.|.....|.....|.|.....|.|.|.............|...|.|...|.|.|.|...|.|.|.|.|.|...|.......|.......|.....|.........|.............|.|...|.|.|.....|...|.|.|...|.|.....|.|...|.....|.|.|...|.|.....
.....|.|.|.|.|.|.|.|...+-+.....|.|...+-|---|-------------|---|-----|-|-|-|---|-|---|-|-|---|-------+.......|.....|.........|.............|.|...|.|.|.....|...|.|.|...|.|.....|.|...|.....|.|.|...|.|.....
.....|.|.|.|.|.|.|.|...|.......|.|...|.|.|.|.............|...|.|...|.|.|.|...|.|.|.|.|.|...|...............|.....|.........|.............|.|...|.|.|.....|...|.|.|...|.|.....|.|...|.....|.|.|...|.|.....
.....|.|.|.|.|.|.|.|...+---------|-------|-|-------------|-----+...|.|.|.|...|.|.|.|.|.|...|...............|.....|.........|.............|.|...|.|.|.....|...|.|.|...|.|.....|.|...|.....|.|.|...|.|.....
.....|.|.|.|.|.|.|.|...........|.|...|.|.|.|.............|...|.....|.|.|.|...|.|.|.|.|.|...|...............|.....|.........|.............|.|...|.|.|.....|...|.|.|...|.|.....|.|...|.....|.|.|...|.|.....
.....|.|.|.|.|.|.|.|...........|.|...|.|.|.|.............|...|.....|.|.+-|-------|-|-----------------------|---+.|.........|.......+---------------|---------|-|-|-----------|-----|-----|-|-|-----|---+.
.....|.|.|.|.|.|.|.|...........|.|...|.|.|.|.............|...|.....|.|...|...|.|.|.|.|.|...|...............|...|.|.........|.......|.....|.|...|.|.|.....|...|.|.|...|.|.....|.|...|.....|.|.|...|.|...|.
...+-|---------|-|-------------------|-----|-------------|---|-----|-|---|-----|-|-----|-------------------|---|-|---------|-------------------|-|-+.....|...+---------|-------|-+.|.....|.|.|...|.|...|.
...|.|.|.|.|.|.|.|.|...........|.|...|.|.|.|.............|...|.....|.|...|...|.|.|.|.|.|...|...............|...|.|.........|.......|.....|.|...|.|.......|.....|.|...|.|.....|.|.|.|.....|.|.|...|.|...|.
...|.|.|.|.|.|.|.|.|...........|.|...|.|.|.|.............|...|.....|.|.+-----|---|-|-----+.|...............|...|.|.........|.......|.....|.|...|.|.......|.....|.|...|.|.+-----|-+.|.....|.|.|...|.|...|.
...|.|.|.|.|.|.|.|.|...........|.|...|.|.|.|.............|...|.....|.|.|.|...|.|.|.|.|.|.|.|...............|...|.|.........|.......|.....|.|...|.|.......|.....|.|...|.|.|...|.|...|.....|.|.|...|.|...|.
...|.|.|.|.|.|.|.|.|...........|.|...|.|.|.|.............|...|.....|.|.|.|...|.|.|.+---|-|-|---------------------------------------------------|-----------+...|.|...|.|.|...|.|...|.....|.|.|...|.|...|.
...|.|.|.|.|.|.|.|.|...........|.|...|.|.|.|.............|...|.....|.|.|.|...|.|.|...|.|.|.|...............|...|.|.........|.......|.....|.|...|.|.......|.|...|.|...|.|.|...|.|...|.....|.|.|...|.|...|.
...|.|.|.|.|.|.|.|.|...........|.|...|.|.|.|.............|...|.....|.|.|.|...|.|.|...|.|.|.|...............|...|.|.........|.......|.....|.|...|.|.+-+...|.|...|.|...|.|.|...|.|...|.....|.|.|...|.|...|.
...|.|.|.|.|.|.|.|.|...........|.|...|.|.|.|.............|...|.....|.|.|.|...|.|.|...|.|.|.|...............|...|.|.........|.......|.....|.|...|.|.|.|...|.|...|.|...|.|.|...|.|...|.....|.|.|...|.|...|.
...|.|.|.|.|.|.|.|.|...+---------|---|-|-|-+.............|...|.....|.|.|.|...|.|.|...|.|.|.|...............|...|.|.........|.......|.....|.|...|.|.|.|...|.|...|.|...|.|.|...|.|...|.....|.|.|...|.|...|.
...|.|.|.|.|.|.|.|.|...|.......|.|...|.|.|...............|...|.....|.|.|.|...|.|.|...|.|.|.|...............|...|.|.........|.......|.....|.|...|.|.|.|...|.|...|.|...|.|.|...|.|...|.....|.|.|...|.|...|.
...|.|.|.|.|.|.+---|---|-------------|-|---------------------|-------|-|-|---|---|---|---------------------|---|-----------|-------|-----|-|-----|-+.|...+-|-+.|.|...|.|.|...|.|...|.....|.|.|...|.|...|.
...|.|.|.|.|.|...|.|...|.......|.|...|.|.|...............|...|.....|.|.|.|...|.|.|...|.|.|.|...............|...|.|.........|.......|.....|.|...|.|...|.....|.|.|.|...|.|.|...|.|...|.....|.|.|...|.|...|.
...|.|.|.|.|.|...|.|.+-------+.+-----|-|-----------------------+...|.|.|.|...|.|.|...|.|.|.|...............|...|.+---------|-------------|-----|-|-----------|---|-+.|.|.|...|.|...|.....|.|.|.+-----+.|.
...|.|.|.|.|.|...|.|.|.|.....|...A...|.|.|...............|...|.|...|.|.|.|...|.|.|...|.|.|.|...............|...|...........|.......|.....|.|...|.|...|.....|.|.|.|.|.|.|.|...|.|...|.....|.|.|.|.|.|.|.|.
...|.|.|.|.|.|...|.|.|.|.....|...|...+-|-----------------|-----|-------|-|-------|---|-|---|-------------------|-----------|-------|-----|-----------|-------|-----|-|-|-----|-----------|---------|-+.|.
...|.|.|.|.|.|...|.|.|.|.....|...|.....|.|...............|...|.|...|.|.|.|...|.|.|...|.|.|.|...............|...|...........|.......|.....|.|...|.|...|.....|.|.|.|.|.|.|.|...|.|...|.....|.|.|.|.|.|...|.
...|.|.|.|.|.|...+-|---------|---|-------|-------------------|---------|-|---|-|-----|---+.|...............|...|...........|.......|.....|.|...|.|.+-------|-+.|.|.|.|.|.|...|.|...|.....|.|.|.|.|.|...|.
...|.|.|.|.|.|.....|.|.|.....|...|.....|.|...............|...|.|...|.|.|.|...|.|.|...|.|...|...............|...|...........|.......|.....|.|...|.|.|.|.....|...|.|.|.|.|.|...|.|...|.....|.|.|.|.|.|...|.
...|.|.|.|.|.|.....|.|.|.....|...|.....|.|...............|...|.|...|.|.|.|...|.|.|...|.|...|...............|.+-|---------------------------|-------|-|-----+.+-----+.|.|.|...|.|.+-------|-----|-|-|-+.|.
...|.|.|.|.|.|.....|.|.|.....|...|.....|.|...............|...|.|...|.|.|.|...|.|.|...|.|...|...............|.|.|...........|.......|.....|.|...|.|.|.|.......|.|.|...|.|.|...|.|.|.|.....|.|.|.|.|.|.|.|.
...|.|.|.|.|.|.....|.+-|-+...+---------|-|-------------------|-|---|---|-|---|---------|---------------------|-------------|-------|-----|-------|-|---------+.|.|...|.|.|...|.|.|.|.....|.|.|.|.|.|.|.|.
...|.|.|.|.|.|.....|...|.|.......|.....|.|...............|...|.|...|.|.|.|...|.|.|...|.|...|...............|.|.|...........|.......|.....|.|...|.|.|.|.........|.|...|.|.|...|.|.|.|.....|.|.|.|.|.|.|.|.
...|.|.|.|.|.|.....|...|.|.......|.....|.|...............|...|.|...|.|.|.|...|.|.|...|.|...|...............|.|.|...........|.......|.....|.|...|.|.|.|...+-------|---|-----+.|.|.|.|.....|.|.|.|.|.|.|.|.
...|.|.|.|.|.|.....|...|.|.......|.....|.|...............|...|.|...|.|.|.|...|.|.|...|.|...|...............|.|.|...........|.......|.....|.|...|.|.|.|...|.....|.|...|.|.|.|.|.|.|.|.....|.|.|.|.|.X.|.|.
...|.|.|.|.|.|.....|...|.|.......|.....|.|...............|...|.|...|.|.|.|...|.|.|...|.|...|.+---------------|-|-------------------|-----------|---+.|...|.....|.|...|.|.|.|.|.|.|.|.....|.|.|.|.|.|.|.|.
...|.|.|.|.|.|.....|...|.|.......|.....|.|...............|...|.|...|.|.|.|...|.|.|...|.|...|.|.............|.|.|...........|.......|.....|.|...|.|...|...|.....|.|...|.|.|.|.|.|.|.|.....|.|.|.|.|.|.|.|.
...|.|.|.|.|.|.....|...|.|.......|.....|.|...............+---|-|-----|---|-----------|-|-------------------------------------------|-------------|-------------|-----|-|-+.|.|.|.|.|.....|.|.|.|.|.|.|.|.
...|.|.|.|.|.|.....|...|.|.......|.....|.|...................|.|...|.|.|.|...|.|.|...|.|...|.|.............|.|.|...........|.......|.....|.|...|.|...|...|.....|.|...|.|...|.|.|.|.|.....|.|.|.|.|.|.|.|.
.+-|---------|-----------------+.|.....|.|...................|.|...|.|.|.|...|.|.|...|.|...|.|.............|.|.|...........|.......|.....|.|...|.|...|...|.....|.|...|.|...|.|.|.|.|.....|.|.|.|.|.|.|.|.
.|.|.|.|.|.|.|.....|...|.|.....|.|.....|.|...................|.|...|.|.|.|...|.|.|...|.|...|.|.............|.|.|...........|.......|.....|.|...|.|...|...|.....|.|...|.|...|.|.|.|.|.....|.|.|.|.|.|.|.|.
.|.|.|.|.|.|.|.....|...|.|.....|.|.....|.|...................|.|...|.|.|.|...|.|.|...|.|...|.|.............|.|.|.+---------|-------|-----|-|-+.|.|...|...|.....|.|...|.|...|.|.|.|.|.....|.|.|.|.|.|.|.|.
.|.|.|.|.|.|.|.....|...|.|.....|.|.....|.|...................|.|...|.|.|.|...|.|.|...|.|...|.|.............|.|.|.|.........|.......|.....|.|.|.|.|...|...|.....|.|...|.|...|.|.|.|.|.....|.|.|.|.|.|.|.|.
.|.|.|.|.|.|.|.....|...|.|.....|.|.....|.|...................|.|...|.|.|.|...|.|.|...|.|...|.|.............|.|.|.|.........|.....+-|-------|---|-----|---|-----------|-----+.|.|.|.|.....|.|.|.|.|.|.|.|.
.|.|.|.|.|.|.|.....|...|.|.....|.|.....|.|...................|.|...|.|.|.|...|.|.|...|.|...|.|.............|.|.|.|.........|.....|.|.....|.|.|.|.|...|...|.....|.|...|.|.....|.|.|.|.....|.|.|.|.|.|.|.|.
.|.|.|.+-----------|---|-|-----|-|-----|---------------------------|-|-|-|---|-|-|---|-------|-----------------|-|---------|-----|-------+.|.|.|.|...|...|...+-------|-----+.|.|.|.|.....|.|.|.|.|.|.|.|.
.|.|.|...|.|.|.....|...|.|.....|.|.....|.|...................|.|...|.|.|.|...|.|.|...|.|...|.|.............|.|.|.|.........|.....|.|.......|.|.|.|...|...|...|.|.|...|.|...|.|.|.|.|.....|.|.|.|.|.|.|.|.
.+-------|-|---------------------|---------------------------------|-----|---|-|-----|-----|-+.............|.|.|.|.........|.....|.|.....+---|-+.+---+...|...|.+-|---|-----|---|---|-+...|.|.|.|.|.|.|.|.
...|.|...|.|.|.....|...|.|.....|.|.....|.|...................|.|...|.|.|.|...|.|.|...|.|...|...............|.|.|.|.........|.....|.|.....|.|.|...........|...|...|...|.|...|.|.|.|.|.|...|.|.|.|.|.|.|.|.
...|.|...|.|.|.....|...|.|.....|.|.....|.|.+-+...........+---|-|---+.|.|.|.+-|---+...|.|...|...............|.|.|.|.........|.....|.|.....|.|.|.........+-|---|---|---------|---|-----+...|.|.|.|.|.|.|.|.
...|.|...|.|.|.....|...|.|.....|.|.....|.|.|.|...........|...|.|.....|.|.|.|.|.|.....|.|...|...............|.|.|.|.........|.....|.|.....|.|.|.........|.|...|...|...|.|...|.|.|.|.|.....|.|.|.|.|.|.|.|.
...+-|-----|-|-----|---|-|-------------|-|-------------+.|...|.|.....|.|.|.|.|.|.....|.|...|...+-----------|-|-------------|-----------------|---------|-|-------|---|-----|-+.|.|.+-+...|.|.|.|.|.|.|.|.
.....|...|.|.|.....|...|.|.....|.|.....|.|.|.|.........|.|...|.|.....|.|.|.|.|.|.....|.|...|...|...........|.|.|.|.........|.....|.|.....|.|.|.........|.|...|...|...|.|...|...|.|...|...|.|.|.|.|.|.|.|.
.....|...|.|.|.....|...|.|...+-|-------+.|.|.|.........|.|...|.|.....|.|.|.|.|.+-----|-|-------|-----------|-|-------------------|-|-------|-----------+.|...|...|...|.|...|...|.|...|...|.|.|.|.|.|.|.|.
.....|...|.|.|.....|...|.|...|.|.|.......|.|.|.........|.|...|.|.....|.|.|.|.|.......|.|...|...|...........|.|.|.|.........|.....|.|.....|.|.|...........|...|...|...|.|...|...|.|...|...|.|.|.|.|.|.|.|.
.+-+.|...+---------|-----|---|-----------|---|-----------|---|-|-----------|-|-------|---------|-----+.....|.|.|.|.........|.....|.|.....|.|.|...........|...|...+---|-|---|---------+...|.|.|.|.|.|.|.|.
.|.|.|.....|.|.....|...|.|...|.|.|.......|.|.|.........|.|...|.|.....|.|.|.|.|.......|.|...|...|.....|.....|.|.|.|.........|.....|.|.....|.|.|...........|...|.......|.|...|...|.|.......|.|.|.|.|.|.|.|.
.+---|-----|-----+.|...|.|...|.|.|.......|.|.|.........|.|...|.|.....|.|.|.|.+-------|-------------+.|.....|.|.|.|.........|.....|.|.....|.|.|...........|...|.......|.|...|...|.|.......|.|.|.|.|.|.|.|.
...|.|.....|.|...|.|...|.|...|.|.|.......|.|.|.........|.|...|.|.....|.|.|.|.........|.|...|...|...|.|.....|.|.|.|.........|.....|.|.....|.|.|...........|...|.......|.|...|...|.|.......|.|.|.|.|.|.|.|.
.+---|-----------------|-----|-|-----------|-----------|-|---|-------|---|-|---------|-|-----------|-------------|---------------|-|-----|-|-------------|-----------+.|...|...|.|.......|.|.|.|.|.|.|.|.
.|.|.|.....|.|...|.|...|.|...|.|.|.......|.|.|.........|.|...|.|.....|.|.|.|.........|.|...|...|...|.|.....|.|.|.|.........|.....|.|.....|.|.|...........|...|.........|...|...|.|.......|.|.|.|.|.|.|.|.
.|.|.|.....|.|...|.|...|.|...|.|.|.......|.|.|.........|.|...+-------|-+.|.|.........|.+---|---------+.....|.|.|.|.........|.....|.|.....|.|.|.........+-|-----------------------|-----------|---|---+.|.
.|.|.|.....|.|...|.|...|.|...|.|.|.......|.|.|.........|.|.....|.....|...|.|.........|.....|...|...|.......|.|.|.|.........|.....|.|.....|.|.|.........|.|...|.........|...|...|.|.......|.|.|.|.|.|...|.
.+-|-|-------|-----|---|-----|---|-------|-|-----------|-------------|---|-----------------|---------------|-|-|-----+.....|.....|.|.....|.+-----------|-+...|.........|.+-|---------+...|.|.|.|.|.|...|.
...|.|.....|.|...|.|...|.|...|.|.|.......|.|.|.........|.|.....|.....|...|.|.........|.....|...|...|.......|.|.|.|...|.....|.....|.|.....|...|.........|.....|.........|.|.|...|.|...|...|.|.|.|.|.|...|.
...|.|...+-|-----|-----+.|...|.|.|.......|.|.|.........|.|.....|.....|...|.|.......+-|-------------|------------Z|---|-----------------------+.........|.....|.........|.|.|...|.|...|...|.|.|.|.|.|...|.
...|.|...|.|.|...|.|.....|...|.|.|.......|.|.|.........|.|.....|.....|...|.|.......|.|.....|...|...|.......|.|.|.|...|.....|.....|.|.....|.............|.....|.........|.|.|...|.|...|...|.|.|.|.|.|...|.
...|.|...|.|.|...|.|.....|.+-+.|.+-----------------------------|-----|-----|---------------|---|---------------|-----+.....|.....|.+-------------------|-----------------|-|---|-|-------|-|-+.|.|.|...|.
...|.|...|.|.|...|.|.....|.|...|.........|.|.|.........|.|.....|.....|...|.|.......|.|.....|...|...|.......|.|.|.|.........|.....|.......|.............|.....|.........|.|.|...|.|...|...|.|...|.|.|...|.
.+-|-+...|.|.|...|.|.....|.|...|.+---------------------+.|.....|.....|...|.|.......|.|.....|...+---|-------|-|-------------|-------------|-------------|-----|-------------|-----|-----+.|.|...|.|.|...|.
.|.|.....|.|.|...|.|.....|.|...|.|.......|.|.|...........|.....|.....|...|.|.......|.|.....|.......|.......|.|.|.|.........|.....|.......|.............|.....|.........|.|.|...|.|...|.|.|.|...|.|.|...|.
.|.|.....|.|.|...|.|.....|.|...|.|...+---|-+.|...........|.....|.....|...|.|.......|.|.....|.......|.......|.|.|.|.........|.....|.......|.............|.....|.........|.|.|...|.|...|.|.|.|...|.|.|...|.
.|.|.....|.|.|...|.|.....|.|...|.|...|...|...|...........|.....|.....|...|.|.......|.|.....|.......|.......|.|.|.|.........|.....|.......|.............|.....|.........|.|.|...|.|...|.|.|.|...|.|.|...|.
.|.|.....|.|.|...|.|.....|.|...|.|...|...|...|...........|.....|.....+---|---------|-|-------------|---------|-|-|-------------------------------------|-----|---+.....|.|.|...|.+-----|-------+.|.|...|.
.|.|.....|.|.|...|.|.....|.|...|.|...|...|...|...........|.....|.........|.|.......|.|.....|.......|.......|.|.|.|.........|.....|.......|.............|.....|...|.....|.|.|...|.....|.|.|.|.....|.|...|.
.|.|.....|.|.|...|.|.....|.|...|.|...|...|...|...........|.....|.........|.|.......|.|.....|.......|.......|.|.|.|.........|.....|.......|.............|.....|...|.....+-------|-----+.+-------+.|.|...|.
.|.|.....|.|.|...|.|.....|.|...|.|...|...|...|...........|.....|.........|.|.......|.|.....|.......|.......|.|.|.|.........|.....|.......|.............|.....|...|.......|.|...|.........|.|...|.|.|...|.
.|.|.....|.|.|...|.|.....|.|...|.|...|...|...|...........|.....|.........|.|.......|.|.....|.......|.......|.|.|.|.........|.....|.......|.............|.....|...|.......|.|...|.........|.|...|.|.|...|.
.|.|.....|.|.|...|.|.....|.|...|.|...|...|...|...........|.....|.........|.|.......|.|.....|.......|.......|.|.|.|.........|.....|.......|.............|.....|...|.......|.|...|.........|.|...|.|.|...|.
.|.|.....|.|.|...|.|.....|.|...|.|...|...|...|...........|.....|.........|.|.......|.|.....|.......|.......|.|.|.|.........|.....|.......|.............|.....|...|.......|.|...|.........|.|...|.|.|...|.
.|.|.....|.|.|...|.|.....|.|...|.|...|...|...|...........|.....|.........|.|.......|.|.....|.......|.......|.|.|.|.........|.....|.......|.............|.....|...|.......|.|...|.........|.|...|.|.|...|.
.|.+-----+.|.|...|.|.....|.+---|-----|-------|---------------------------|-+.......|.|.....|.......|.......|.|.|.|.........|.....|.......|.............|.....|...|.......|.|...|.........|.|...|.|.|...|.
.|.........|.|...|.|.....|.....|.|...|...|...|...........|.....|.........|.........|.|.....|.......|.......|.|.|.|.........|.....|.......|.............|.....|...|.......|.|...|.........|.|...|.|.|...|.
.|.+---------|-----|-----|-----|-+...|...|...|...........|.....+---------------------------|-------|-------|-|-|-----+.....|.....|.......|.............|.....|...|.......|.|...|.........|.|...|.|.|...|.
.|.|.......|.|...|.|.....|.....|.....|...|...|...........|...............|.........|.|.....|.......|.......|.|.|.|...|.....|.....|.......|.............|.....|...|.......|.|...|.........|.|...|.|.|...|.
.|.|.......|.|...|.|.....|.....|.....|...|...|...........|...............|.........|.|.....|.......|.......|.|.|.|...|.....|.....|.......+-------------|--I--------+.....|.|...|.........|.|...|.|.|...|.
.|.|.......|.|...|.|.....|.....|.....|...|...|...........|...............|.........|.|.....|.......|.......|.|.|.|...|.....|.....|.....................|.....|...|.|.....|.|...|.........|.|...|.|.|...|.
.|.|.......|.|...|.|.....|.....|.....|...|...|.........+-----------------+.........|.|.....|.......|.......|.|.|.|...|.....|.....|.....................|.....|...|.|.....|.|...|.........|.|...|.|.|...|.
.|.|.......|.|...|.|.....|.....|.....|...|...|.........|.|.........................|.|.....|.......|.......|.|.|.|...|.....|.....|.....................|.....|...|.|.....|.|...|.........|.|...|.|.|...|.
.|.|.......|.|...|.|.....|.+---|-------------------------|---------------------------|-----|---+...|.......|.|.|.|...|.....|.....|.....................|.....|...|.|.....|.+-+.|.....+-+.|.|...|.|.|...|.
.|.|.......|.|...|.|.....|.|...|.....|...|...|.........|.|.........................|.|.....|...|...|.......|.|.|.|...|.....|.....|.....................|.....|...|.|.....|...|.|.....|.|.|.|...|.|.|...|.
.|.|.......|.|...|.|.....|.|...|.....|...|.+-|---------|-|---------------------------|-----|---+...|.......|.|.|.|...|.....|.....|.....................|.....|...+-----------|-|-----+.|.|.|...|.|.|...|.
.|.|.......|.|...|.|.....|.|...|.....|...|.|.|.........|.|.........................|.|.....|.......|.......|.|.|.|...|.....|.....|.....................|.....|.....|.....|...|.|.......|.|.|...|.|.|...|.
.+-|-------------|---------|---------|---|-|-|---------|-|---------------------------------|-------|-------|-|-------------------------------------+.+-|-----|---------------|-|---+...|.|.|...|.|.|...|.
...|.......|.|...|.|.....|.|...|.....|...|.|.|.........|.|.........................|.|.....|.......|.......|.|.|.|...|.....|.....|.................|.|.|.....|.....|.....|...|.|...|...|.|.|...|.|.|...|.
...|.......|.|...|.|.....|.|...|.....|...+---+.........|.+---------------------------------|---------------|-----------------------------------+...+-|-----------------------------+...|.|.|...|.|.|...|.
...|.......|.|...|.|.....|.|...|.....|.....|...........|...........................|.|.....|.......|.......|.|.|.|...|.....|.....|.............|.....|.|.....|.....|.....|...|.|.......|.|.|...|.|.|...|.
...|.......|.+-+.+-------------------|-----|---------------+.......................|.|.....|...+---|-------|-|---|---|-----------|-------------|-----|-+.....|...+-+.....|...|.|.......|.|.|...|.|.|...|.
...|.......|...|...|.....|.|...|.....|.....|...........|...|.......................|.|.....|...|...|.......|.|.|.|...|.....|.....|.............|.....|.......|...|.......|...|.|.......|.|.|...|.|.|...|.
...|.......|...|...+-----+.+---------|-----------------|---|-----------------------+.|.....|...|...+-----------|-|---|-------------------------------|-------|-----------|-------------+.|.|...|.|.|...|.
...|.......|...|...............|.....|.....|...........|...|.........................|.....|...|...........|.|.|.|...|.....|.....|.............|.....|.......|...|.......|...|.|.........|.|...|.|.|...|.
...+-------|---|---------------------------|---------------------------------------------------|---------------|-|---|-----------|-------------+.....|.......|...|.......|...|.|.........|.|...|.|.|...|.
...........|...|...............|.....|.....|...........|...|.........................|.....|...|...........|.|.|.|...|.....|.....|...................|.......|...|.......|...|.|.........|.|...|.|.|...|.
...........+-------------------|-----|-----|---------------|-----------------------------------|-------------|-------------------|-------------------|-------|---------------|-|---------|-----|-+.|...|.
...............|...............|.....|.....|...........|...|.........................|.....|...|...........|.|.|.|...|.....|.....|...................|.......|...|.......|...|.|.........|.|...|...|...|.
...............|.........+-----------------|-----------+...|.........................|.....|...|...........|.|.|.|...|.....|.....|...................+-------|---|-----------------+.....|.|...|...|...|.
...............|.........|.....|.....|.....|...............|.........................|.....|...|...........|.|.|.|...|.....|.....|...........................|...|.......|...|.|...|.....|.|...|...|...|.
...............|.........+-----------|U----|---------------+.........................|.....|...|...........|.|.|.|...|.....|.....|...........................|...|.......+-----|---|-------|---|-------+.
...............|...............|.....|.....|.........................................|.....|...|...........|.|.|.|...|.....|.....|...........................|...|...........|.|...|.....|.|...|...|.....
.............+-|---------------------|-----------------------------------------------|-+...|...|...........|.|.|.|...|.....|.....|...........................|...|...........|.|...|.....|.|...|...|.....
.............|.|...............|.....|.....|.........................................|.|...|...|...........|.|.|.|...|.....|.....|...........................|...|...........|.|...|.....|.|...|...|.....
.............|.|...............|.....|.....|.........................................|.|...|...|...........|.|.|.|...|.....|.....|.........................+-----+...........|.|...|.....|.|...|...|.....
.............|.|...............|.....|.....|.........................................|.|...|...|...........|.|.|.|...|.....|.....|.........................|.|...............|.|...|.....|.|...|...|.....
.............|.|...............|.....|.....|...........+-----------------------------|-----|---|--------S--|-|---|---------------|---------------------------|---------------+.|.+-+.....+-|-------+.....
.............|.|...............|.....|.....|...........|.............................|.|...|...|...........|.|.|.|...|.....|.....|.........................|.|.................|.|.........|...|.........
.............|.|...............|.....|.....|...........|.............................|.|...|...|...........|.+-------------+.....+---------------------------+...............+---+.........|...|.........
.............|.|...............|.....|.....|...........|.............................|.|...|...|...........|...|.|...|.....................................|.................|.|...........|...|.........
.............|.|...............|.....|.....|.........+-|-----------------------------|-----|---|-----------|-----|-------------------------------------------+.....+---------|-|-----------------------+.
.............|.|...............|.....|.....|.........|.|.............................|.|...|...|...........|...|.|...|.....................................|.|.....|.........B.|...........|...|.......|.
...+---------|-|---------------------|-----------------------------------------------|-+...|.+-----------------------|---------------------------------------------|-----------------+.....|...|.......|.
...|.........|.|...............|.....|.....|.........|.|.............................|.....|.|.|...........|...|.|...|.....................................|.|.....|.........|.|.....|.....|...|.......|.
.Y.+---------|-----------------------+.....+-----------------------------------------+.....+-|-------------|-----|---|---------------------------------------|-----|-----+.+-+.+-+...|.....|...|.......|.
.|...........|.|...............|.....................|.|.....................................|.|...........|...|.|...|.....................................|.|.....|.....|.|.....|...|.....|...|.......|.
.|...........|.|...............|...+-----------------+.+-------------------------------------+.|...........|...+-+...+-------------------------------------|-|-------------|-----|-------+.|...|.......|.
.|...........|.|...............|...|...........................................................|...........|...............................................|.|.....|.....|.|.....|...|...|.|...|.......|.
.|.......+---+.|...............|...|...........................................................+--------------------------------------------W----------------|-----|-----+.+-----+...+-----+...+-------+.
.|.......|.....|...............|...|.......................................................................|...............................................|.|.....|.....................|...............
.+-------+.....+---------------+...+-----------------------------------------------------------------------+...............................................+-+.....+---------------------+...............
.........................................................................................................................................................................................................
".lines().map(|l|l.chars().collect::<Vec<_>>()).collect::<Vec<_>>();
    let mv = Move::new(&map);
    let mut c = 1;
    let s: String = mv.inspect(|x|{c+=1;})
        .map(|(x, y)|map[y as usize][x as usize])
        .filter(|&c| c != '.' && c != '|' && c != '-' && c != '+')
        .collect();

    println!("{} {}", s,c);
}

